pipeline {
 agent {
    docker{
      image 'ruby'

    }

 }

   stages {
       stage('build'){
         steps{
           echo  'Building or Resolve Dependecies!'
            sh 'rm -f Gemfile.lock'
            sh 'bundle install'
     }  
   }
   stage('test'){
         steps{
           echo 'Running regression tests' 
             sh 'bundle exec cucumber -p ci'

        }    
         post{
                always{
                    cucumber failedFeaturesNumber: -1, failedScenariosNumber: -1, failedStepsNumber: -1, fileIncludePattern: '**/*.json', pendingStepsNumber: -1, skippedStepsNumber: -1, sortingMethod: 'ALPHABETICAL', undefinedStepsNumber: -1
                }
            }
        }

    stage('UAT'){
         steps{
           echo  'Wait for User Acceptance'
               input(message: 'Go to production?',  ok: 'Yes') 
         }
    }
    
    stage('Prod'){
         steps{
           echo  'Web App is ready!'
         }
    }

    stage('Akaue1'){
         steps{
           echo  'Parabens cara!'
         }
    }

 }
}